1 REM CONVOY
5 PRINT"{clear}{space*16}{yellow}convoy{down*12}":POKE53281,11:POKE53280,11
10 V=53248:POKE2040,192:POKE2041,193:POKE2042,193:POKE2043,193:POKE2044,193
15 POKEV+39,11:POKEV+40,0:POKEV+41,0:POKEV+42,0:POKEV+43,0
20 FORI=12288TO12350:READQ:POKEI,Q:NEXT
30 FORI=12352TO12414:READQ:POKEI,Q:NEXT
50 FORI=49152TO49300:READQ:POKEI,Q:NEXT
60 VL=54296:W=54276:A=54277:HI=54273:LW=54272
70 POKEV+16,0
90 PRINT"{space*11}hit any key to start"
95 GETX$:IFX$=""THEN95
100 PRINT"{clear}";
105 FORI=1024TO1263:POKEI,160:POKEI+54272,14:NEXT
110 FORI=1264TO1423:POKEI,102:POKEI+54272,9:NEXT
115 FORI=1424TO1583:POKEI,160:POKEI+54272,12:NEXT
120 FORI=1584TO1943:POKEI,160:POKEI+54272,6:NEXT
130 GOSUB1000:POKEV,178:POKEV+1,145:POKEV+21,1
140 NT=1:POKE178,1:MD=25:GOSUB400
150 POKEV+30,0:PRINT"{home}{down*24}{right*2}bomb:{home}";:POKE56263,7
200 SYS(49152)
205 IFFS=0ANDRND(1)<.2THENFL=INT(RND(1)*9+1):FS=1:TI$="000000"
207 GOSUB1100
210 SYS(49206):IF(PEEK(V+21)AND30)=0THENJ=1:GOSUB420
212 IFPEEK(181)<>1THEN215
214 IFC(PEEK(178))=0THEN800
215 SYS(49152):K=PEEK(178):XP=PEEK(V+2*K)+2^(8-K)*(PEEK(V+16)AND2^K):C=INT(XP/8)
217 IFPEEK(1304+C)=160ANDPEEK(1302+C)=160ANDPEEK(1303+C)=160THENGOSUB550
220 K=PEEK(197):IFK<>60THEN240
225 XP=PEEK(V)+256*(PEEK(V+16)AND1):PC=INT((XP-11)/8)
230 IFPEEK(1384+PC)<>160ANDBS=0THENGOSUB500:GOTO240
235 IFPEEK(1384+PC)=160THENGOSUB350
240 SYS(49152):IFFS=1ANDBS=0ANDINT(TI/60)>FLTHEN700
245 IFBS=1ANDINT(TI/60)>FLTHENGOSUB450
250 IFRND(1)<.02+SC/10000THENGOSUB400
260 GOTO200
350 IFPC<3THEN380
352 IFPC>36THEN392
355 FORJ=1264TO1384STEP40:FORK=PC-2TOPC+2
360 IFPEEK(J+K)=160THENPOKEJ+K,102:POKEJ+K+54272,9
365 NEXT:NEXT:RETURN
380 FORJ=1264TO1384STEP40:FORK=0TOPC
385 IFPEEK(J+K)=160THENPOKEJ+K,102:POKEK+J+54272,9
390 NEXT:NEXT:RETURN
392 FORJ=1264TO1384STEP40:FORK=37TO39
394 IFPEEK(J+K)=160THENPOKEJ+K,102:POKEJ+K+54272,9
396 NEXT:NEXT:RETURN
400 J=0:FORI=1TO4:IF(PEEK(V+21)AND2^I)=0THENJ=I
405 NEXT
410 IFJ=0THENRETURN
412 TE=(PEEK(V+21)AND30)
415 XP=PEEK(V+2*NT)+2^(8-NT)*(PEEK(V+16)AND2^NT):IF326-XP<MDANDTE<>0THENRETURN
420 NT=J:POKEV+2*NT,70:POKEV+16,PEEK(V+16)OR2^NT:POKEV+2*NT+1,80
425 IFRND(1)<.6THENC(NT)=0:GOTO435
430 C(NT)=2
435 POKEV+39+NT,C(NT):POKEV+21,PEEK(V+21)OR2^NT
440 RETURN
450 GOSUB1200
460 FS=0:POKE1424+BP,160:BS=0:IFBP=39THEN480
462 IFBP=0THEN490
465 FORJ=1264TO1384STEP40:FORK=BP-1TOBP+1
470 POKEJ+K,160:POKEJ+K+54272,12:NEXT:NEXT
475 POKEVL,0:POKEA,0:POKEW,0
478 RETURN
480 FORJ=1264TO1384STEP40:FORK=37TO39
482 POKEJ+K,160:POKEJ+K+54272,12:NEXT:NEXT
485 GOTO475
490 FORJ=1264TO1384STEP40:FORK=0TO2
492 POKEJ+K,160:POKEJ+K+54272,12:NEXT:NEXT
495 GOTO475
500 BS=1:BP=PC:POKE1424+PC,209
520 RETURN
550 FORY=80TO155STEP3
555 SYS(49152):POKEV+2*K+1,Y:IF(PEEK(V+30)AND(1+2^K))<>0THEN800
558 GOSUB1100:NEXT
560 IF(PEEK(V+39+K)AND15)=2THEN800
565 SC=SC+50:GOSUB1000:POKEV+21,PEEK(V+21)AND(255-2^K)
570 GOSUB400:RETURN
700 FORI=15TO0STEP-1:POKE12288+INT(RND(1)*62),INT(RND(1)*128)
705 POKEVL,I:POKEW,129:POKEA,15:POKEHI,40:POKELW,200:NEXT
710 POKEW,0:POKEA,0
720 FORT=1TO1000:NEXT
800 POKE53281,0:POKE53280,0:PRINT"{clear}{space*16}{cyan}game over"
805 POKEV+21,0
810 PRINT"{down*14}{space*11}your score was: ";SC
820 GETX$:IFX$=""THENEND
830 GOTO820
1000 PRINT"{down*24}{right*21}{yellow}score: ";SC;"{home}";
1010 RETURN
1100 I=FL-INT(TI/60):IFI<0THENI=0
1110 IFFS=0THENPOKE1991,32:RETURN
1115 POKE1991,48+I
1120 RETURN
1200 POKEVL,15:POKEW,129:POKEA,15:POKEHI,40:POKELW,200
1210 RETURN
10000 DATA0,24,0,0,60,0,0,24,0,1,24,128,0,189,0,0,90,0,0,24,0,0,24,0,0,36,0
10010 DATA0,66,0,255,255,255,255,255,254,127,255,252,127,255,252,63,255,248
10020 DATA63,255,248,15,255,224,7,255,192,0,0,0,0,0,0,0,0,0
10030 DATA0,255,255,0,255,255,0,248,127,0,240,127,0,231,15,62,207,15,126,207,31
10040 DATA254,207,255,254,207,31,255,207,15,255,231,15,255,240,127,255,248,127
10050 DATA127,255,255,60,255,255,60,255,255,56,60,120,24,24,48,0,0,0,0,0,0,0,0,0
10100 DATA165,197,201,33,208,22,56,173,0,208,233,4,141,0,208,201,252,144,8,173
10110 DATA16,208,41,254,141,16,208,96,201,41,208,251,24,173,0,208,105,4,141,0
10120 DATA208,201,4,176,8,173,16,208,9,1,141,16,208,96
10200 DATA169,0,133,181,230,178,165,178,201,5,208,4,169,1,133,178,170,189,141
10210 DATA192,133,179,165,178,10,170,173,21,208,37,179,240,227,56,189,0,208
10220 DATA233,5,157,0,208,201,251,144,11,169,255,56,229,179,45,16,208,141,16
10230 DATA208,165,179,45,16,208,208,22,189,0,208,201,3,176,15,169,255,56,229
10240 DATA179,45,21,208,141,21,208,169,1,133,181,96,0,2,4,8,16,32,64,128
